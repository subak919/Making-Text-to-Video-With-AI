Opposition from rights groups and legal challenges ahead.